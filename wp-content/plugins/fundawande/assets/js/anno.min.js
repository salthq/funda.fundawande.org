!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("jQuery"));else if("function"==typeof define&&define.amd)define(["jQuery"],e);else{var n=e("object"==typeof exports?require("jQuery"):t.jQuery);for(var o in n)("object"==typeof exports?exports:t)[o]=n[o]}}(this,function(t){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o,r,i=[].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1};o=n(1),n(2),e.Anno=function(){function t(e){var n,o,r,i;e.__proto__===Array.prototype?(o=e.shift(),r=e):o=e,o instanceof t&&console.warn("Anno constructor parameter is already an Anno object."),null==o&&console.warn("new Anno() created with no options. It's recommended to supply at least target and content.");for(n in o)i=o[n],"chainTo"!==n&&"start"!==n&&"show"!==n&&"hide"!==n&&"hideAnno"!==n&&"chainSize"!==n&&"chainIndex"!==n&&"version"!==n||console.warn("Anno: Overriding '"+n+"' is not recommended. Can you override a delegated function instead?");for(n in o)i=o[n],this[n]=i;(null!=r?r.length:void 0)>0&&this.chainTo(new t(r))}return t.setDefaults=function(e){var n,o,r;r=[];for(n in e)o=e[n],r.push(t.prototype[n]=o);return r},t.prototype.chainTo=function(e){return null!=e?null==this._chainNext?(this._chainNext=e instanceof t?e:new t(e),this._chainNext._chainPrev=this):this._chainNext.chainTo(e):console.error("Can't chainTo a null object."),this},t.prototype._chainNext=null,t.prototype._chainPrev=null,t.chain=function(e){return console.warn("Anno.chain([...]) is deprecated. Use `new Anno([...])` instead."),new t(e)},t.prototype.chainSize=function(){return null!=this._chainNext?this._chainNext.chainSize():1+this.chainIndex()},t.prototype.chainIndex=function(t){var e;return null!=t?(e=function(t,n,o){var r;return null==t?console.error("Couldn't switch to index '"+n+"'. Chain size is '"+o+"'"):0<=(r=t.chainIndex())&&r<n?e(t._chainNext,n,o):n<r&&r<=o?e(t._chainPrev,n,o):r===n?t:void 0})(this,t,this.chainSize()):null!=this._chainPrev?1+this._chainPrev.chainIndex():0},t.prototype.show=function(){var t,e;return t=this.targetFn(),null!=this._annoElem&&console.warn("Anno elem for '"+this.target+"' has already been generated.  Did you call show() twice?"),this._annoElem=this.annoElem(),this.emphasiseTarget(),this.showOverlay(),t.after(this._annoElem),this._annoElem.addClass("anno-target-"+this.arrowPositionFn()),this.positionAnnoElem(),setTimeout(function(t){return function(){return t._annoElem.removeClass("anno-hidden")}}(this),50),t.scrollintoview(),setTimeout(function(t){return function(){return t._annoElem.scrollintoview()}}(this),300),e=this._annoElem.find("button").last(),this.rightArrowClicksLastButton&&e.keydown(function(t){if(39===t.keyCode)return o(this).click()}),this.autoFocusLastButton&&0===t.find(":focus").length&&e.focus(),this._returnFromOnShow=this.onShow(this,t,this._annoElem),this},t.prototype.start=function(){return this.show()},t.prototype.rightArrowClicksLastButton=!0,t.prototype.autoFocusLastButton=!0,t.prototype.onShow=function(t,e,n){},null,t.prototype.hide=function(){return this.hideAnno(),setTimeout(this.hideOverlay,50),this},t.prototype.hideAnno=function(){return null!=this._annoElem?(this._annoElem.addClass("anno-hidden"),this.deemphasiseTarget(),this.onHide(this,this.targetFn(),this._annoElem,this._returnFromOnShow),function(t){setTimeout(function(){return t.remove()},300)}(this._annoElem),this._annoElem=null):console.warn("Can't hideAnno() for '"+this.target+"' when @_annoElem is null.  Did you call hideAnno() twice?"),this},t.prototype.onHide=function(t,e,n,o){},t.prototype.switchTo=function(t){return null!=t?(this.hideAnno(),t.show()):(console.warn("Can't switchTo a null object. Hiding instead."),this.hide())},t.prototype.switchToChainNext=function(){return this.switchTo(this._chainNext)},t.prototype.switchToChainPrev=function(){return this.switchTo(this._chainPrev)},t.prototype.target="h1",t.prototype.targetFn=function(){var t;return"string"==typeof this.target?(t=o(this.target).filter(":not(.anno-placeholder)"),0===t.length&&console.error("Couldn't find Anno.target '"+this.target+"'."),t.length>1&&console.warn("Anno target '"+this.target+"' matched "+t.length+" elements. Targeting the first one."),t.first()):this.target instanceof jQuery?(this.target.length>1&&console.warn("Anno jQuery target matched "+this.target.length+" elements. Targeting the first one."),this.target.first()):this.target instanceof HTMLElement?o(this.target):"function"==typeof this.target?this.target():(console.error("Unrecognised Anno.target. Please supply a jQuery selector string, a jQuery object, a raw DOM element or a function returning a jQuery element. target:"),console.error(this.target))},t.prototype.annoElem=function(){return this._annoElem=o("<div class='anno anno-hidden "+this.className+"'>\n<div class='anno-inner'>  <div class='anno-arrow'></div>  </div>\n</div>"),this._annoElem.find(".anno-inner").append(this.contentElem()).append(this.buttonsElem()),this._annoElem},t.prototype._annoElem=null,t.prototype.className="",t.prototype.content="Lorem ipsum dolor sit amet, consectetur adipiscing elit.",t.prototype.contentFn=function(){return this.content},t.prototype.contentElem=function(){return o("<div class='anno-content'>"+this.contentFn()+"</div>")},t.prototype.showOverlay=function(){var t;return 0===o(".anno-overlay").length?(o("body").append(t=this.overlayElem().addClass("anno-hidden")),setTimeout(function(){return t.removeClass("anno-hidden")},10)):o(".anno-overlay").replaceWith(this.overlayElem())},t.prototype.overlayElem=function(){return o("<div class='anno-overlay "+this.overlayClassName+"'></div>").click(function(t){return function(e){return t.overlayClick.call(t,t,e)}}(this))},t.prototype.overlayClassName="",t.prototype.overlayClick=function(t,e){return t.hide()},t.prototype.hideOverlay=function(){return o(".anno-overlay").addClass("anno-hidden"),setTimeout(function(){return o(".anno-overlay").remove()},300)},t.prototype.emphasiseTarget=function(t){var e,n,o,r,i,s,l,c,a,h;return null==t&&(t=this.targetFn()),this._undoEmphasise=[],t.closest(":scrollable").on("mousewheel",function(t){return t.preventDefault(),t.stopPropagation()}),this._undoEmphasise.push(function(t){return t.closest(":scrollable").off("mousewheel")}),"static"===t.css("position")&&(t.after(l=t.clone().addClass("anno-placeholder")),function(t){return function(e){return t._undoEmphasise.push(function(){return e.remove()})}}(this)(l),a=t.prop("style").position,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({position:e})})}}(this)(a),t.css({position:"absolute"}),t.outerWidth()!==l.outerWidth()&&(i=t.prop("style").width,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({width:e})})}}(this)(i),t.css("width",l.outerWidth())),t.outerHeight()!==l.outerHeight()&&(n=t.prop("style").height,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({height:e})})}}(this)(n),t.css("height",l.outerHeight())),c=l.position(),h=t.position(),h.top!==c.top&&(r=t.prop("style").top,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({top:e})})}}(this)(r),t.css("top",c.top)),h.left!==c.left&&(o=t.prop("style").left,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({left:e})})}}(this)(o),t.css("left",c.left))),"rgba(0, 0, 0, 0)"!==t.css("backgroundColor")&&"transparent"!==t.css("backgroundColor")||(console.warn("Anno.js target '"+this.target+"' has a transparent bg; filling it white temporarily."),e=t.prop("style").background,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({background:e})})}}(this)(e),t.css({background:"white"})),s=t.prop("style").zIndex,function(t){return function(e){return t._undoEmphasise.push(function(t){return t.css({zIndex:e})})}}(this)(s),t.css({zIndex:"1001"}),t},t.prototype._undoEmphasise=[],t.prototype.deemphasiseTarget=function(){var t,e,n,o;for(t=this.targetFn(),o=this._undoEmphasise,e=0,n=o.length;e<n;e++)(0,o[e])(t);return t},t.prototype.position=null,t.prototype.positionAnnoElem=function(t){var e,n,o;switch(null==t&&(t=this._annoElem),o=this.positionFn(),e=this.targetFn(),n=e.position(),o){case"top":case"bottom":t.css({left:n.left+"px"});break;case"center-top":case"center-bottom":t.css({left:n.left+(e.outerWidth()/2-t.outerWidth()/2)+"px"});break;case"left":case"right":t.css({top:n.top+"px"});break;case"center-left":case"center-right":t.css({top:n.top+(e.outerHeight()/2-t.outerHeight()/2)+"px"})}switch(o){case"top":case"center-top":t.css({top:n.top-t.outerHeight()+"px"});break;case"bottom":case"center-bottom":t.css({top:n.top+e.outerHeight()+"px"});break;case"left":case"center-left":t.css({left:n.left-t.outerWidth()+"px"});break;case"right":case"center-right":t.css({left:n.left+e.outerWidth()+"px"});break;default:null!=o.left||null!=o.right||null!=o.top||null!=o.bottom?t.css(o):console.error("Unrecognised position: '"+o+"'")}return t},t.prototype.positionFn=function(){var e,n,r,s,l,c,a,h,u;return null!=this.position?this.position:null!=this._annoElem?(n=this.targetFn(),e=n.closest(":scrollable"),0===e.length&&(e=o("body")),h=n.offset(),c=e.offset(),a={left:h.left-c.left,top:h.top-c.top},a.right=a.left+n.outerWidth(),a.bottom=a.top+n.outerHeight(),u={w:e.width()||e.width(),h:e.height()||e.height()},s={w:this._annoElem.outerWidth(),h:this._annoElem.outerHeight()},l=[],s.w>a.left&&(l=l.concat(["left","center-left"])),s.h>a.top&&(l=l.concat(["top","center-top"])),s.w+a.right>u.w&&(l=l.concat(["right","center-right"])),s.h+a.bottom>u.h&&(l=l.concat(["bottom","center-bottom"])),r=t.preferredPositions.filter(function(t){return i.call(l,t)<0}),0===r.length?console.error("Anno couldn't guess a position for '"+this.target+"'. Please supply one in the constructor."):console.warn("Anno: guessing position:'"+r[0]+"' for '"+this.target+"'. Possible Anno.preferredPositions: ["+r+"]."),this.position=r[0]):void 0},t.preferredPositions=["bottom","right","left","top","center-bottom","center-right","center-left","center-top"],t.prototype.arrowPositionFn=function(){var t,e;return null!=this.arrowPosition?this.arrowPosition:"string"==typeof this.positionFn()?{top:"bottom","center-top":"center-bottom",left:"right","center-left":"center-right",right:"left","center-right":"center-left",bottom:"top","center-bottom":"center-top"}[this.positionFn()]:(t={l:parseInt(this.positionFn().left,10),t:parseInt(this.positionFn().top,10)},e=Math.abs(t.l)>Math.abs(t.t)?t.l<0?"center-right":"center-left":t.t<0?"center-bottom":"center-top",console.warn("Guessing arrowPosition:'"+e+"' for "+this.target+". Include this in your constructor for consistency."),e)},t.prototype.arrowPosition=null,t.prototype.buttons=[{}],t.prototype.buttonsFn=function(){return this.buttons instanceof Array?this.buttons.map(function(t){return new r(t)}):[new r(this.buttons)]},t.prototype.buttonsElem=function(){var t;return o("<div class='anno-btn-container'></div>").append(function(){var e,n,o,r;for(o=this.buttonsFn(),r=[],e=0,n=o.length;e<n;e++)t=o[e],r.push(t.buttonElem(this));return r}.call(this))},t}(),e.AnnoButton=r=function(){function t(t){var e,n;for(e in t)n=t[e],this[e]=n}return t.prototype.buttonElem=function(t){return o("<button class='anno-btn'></button>").html(this.textFn(t)).addClass(this.className).click(function(e){return function(n){return e.click.call(t,t,n)}}(this))},t.prototype.textFn=function(t){return null!=this.text?this.text:null!=t._chainNext?"Next":"Done"},t.prototype.text=null,t.prototype.className="",t.prototype.click=function(t,e){return null!=t._chainNext?t.switchToChainNext():t.hide()},t.NextButton=new t({text:"Next",click:function(){return this.switchToChainNext()}}),t.DoneButton=new t({text:"Done",click:function(){return this.hide()}}),t.BackButton=new t({text:"Back",className:"anno-btn-low-importance",click:function(){return this.switchToChainPrev()}}),t}()},function(e,n,o){e.exports=t},function(t,e,n){!function(t){var e={vertical:{x:!1,y:!0},horizontal:{x:!0,y:!1},both:{x:!0,y:!0},x:{x:!0,y:!1},y:{x:!1,y:!0}},n={duration:"fast",direction:"both"},o=/^(?:html)$/i,r=function(e,n){n=n||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle);var o=!(!document.defaultView||!document.defaultView.getComputedStyle),r={top:parseFloat(o?n.borderTopWidth:t.css(e,"borderTopWidth"))||0,left:parseFloat(o?n.borderLeftWidth:t.css(e,"borderLeftWidth"))||0,bottom:parseFloat(o?n.borderBottomWidth:t.css(e,"borderBottomWidth"))||0,right:parseFloat(o?n.borderRightWidth:t.css(e,"borderRightWidth"))||0};return{top:r.top,left:r.left,bottom:r.bottom,right:r.right,vertical:r.top+r.bottom,horizontal:r.left+r.right}},i=function(e){var n=t(window),i=o.test(e[0].nodeName);return{border:i?{top:0,left:0,bottom:0,right:0}:r(e[0]),scroll:{top:(i?n:e).scrollTop(),left:(i?n:e).scrollLeft()},scrollbar:{right:i?0:e.innerWidth()-e[0].clientWidth,bottom:i?0:e.innerHeight()-e[0].clientHeight},rect:function(){var t=e[0].getBoundingClientRect();return{top:i?0:t.top,left:i?0:t.left,bottom:i?e[0].clientHeight:t.bottom,right:i?e[0].clientWidth:t.right}}()}};t.fn.extend({scrollintoview:function(r){r=t.extend({},n,r),r.direction=e["string"==typeof r.direction&&r.direction.toLowerCase()]||e.both;var s="";!0===r.direction.x&&(s="horizontal"),!0===r.direction.y&&(s=s?"both":"vertical");var l=this.eq(0),c=l.closest(":scrollable("+s+")");if(c.length>0){c=c.eq(0);var a={e:i(l),s:i(c)},h={top:a.e.rect.top-(a.s.rect.top+a.s.border.top),bottom:a.s.rect.bottom-a.s.border.bottom-a.s.scrollbar.bottom-a.e.rect.bottom,left:a.e.rect.left-(a.s.rect.left+a.s.border.left),right:a.s.rect.right-a.s.border.right-a.s.scrollbar.right-a.e.rect.right},u={};!0===r.direction.y&&(h.top<0?u.scrollTop=a.s.scroll.top+h.top:h.top>0&&h.bottom<0&&(u.scrollTop=a.s.scroll.top+Math.min(h.top,-h.bottom))),!0===r.direction.x&&(h.left<0?u.scrollLeft=a.s.scroll.left+h.left:h.left>0&&h.right<0&&(u.scrollLeft=a.s.scroll.left+Math.min(h.left,-h.right))),t.isEmptyObject(u)?t.isFunction(r.complete)&&r.complete.call(c[0]):(o.test(c[0].nodeName)&&(c=t("html,body")),c.animate(u,r.duration).eq(0).queue(function(e){t.isFunction(r.complete)&&r.complete.call(c[0]),e()}))}return this}});var s={auto:!0,scroll:!0,visible:!1,hidden:!1};t.extend(t.expr[":"],{scrollable:function(t,n,r,i){var l=e["string"==typeof r[3]&&r[3].toLowerCase()]||e.both,c=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle,a={x:s[c.overflowX.toLowerCase()]||!1,y:s[c.overflowY.toLowerCase()]||!1,isRoot:o.test(t.nodeName)};if(!a.x&&!a.y&&!a.isRoot)return!1;var h={height:{scroll:t.scrollHeight,client:t.clientHeight},width:{scroll:t.scrollWidth,client:t.clientWidth},scrollableX:function(){return(a.x||a.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(a.y||a.isRoot)&&this.height.scroll>this.height.client}};return l.y&&h.scrollableY()||l.x&&h.scrollableX()}})}(jQuery)}])});